<?xml version="1.0"?>
<AlteryxDocument yxmdVer="2023.1">
  <Nodes>
    <Node ToolID="1">
      <GuiSettings Plugin="AlteryxBasePluginsGui.DbFileInput.DbFileInput">
        <Position x="54" y="103" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Passwords>4D2E9A25A7E15EA6BA42A55A819B788885FAB3AB9BE53668A17CB42D45EE5BEB2C6F3</Passwords>
          <File RecordLimit="" FileFormat="23">odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select 
cusExSupplyTracker_ExternaSupplier.id,
cusExSupplyTracker_ExternaSupplier.Name as SupplierName,
cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,
cusExSupplyTracker_ExternaSupplier.EcovadisID,
cusExSupplyTracker_ExternaSupplier.CdpID,
cusexsupplytracker_externasupplier.smdrericaid,
cusexsupplytracker_externasupplier.smdmodifieddate,
cusExSupplyTracker_ExternaSupplier.SupplierParent,
cusExSupplyTracker_ExternaSupplier.Address,
cusExSupplyTracker_ExternaSupplier.City,
cusMDataManagement_Countries.caption as Country,
BuyerRegion.caption as BuyerRegion,
SupplierRegion.caption as SupplierRegion,
cusMDataManagement_Sectors.name as Sector,
cusExSupplyTracker_ExternaSupplier.CurveID,
cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,
cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,
cusMDataManagement_SuppliScorecard.Scorecard,
scorecardbusinessunit.name as ScorecardBusinessUnit,
RollupSector.name as rollupsector,
cusMDataManagement_Pcategoryfamily.name as CategoryFamily,
cusMDataManagement_PSICategory.name as ExternalSupplyCategory,
case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,
cusExSupplyTracker_Category.spend,
cusMDataManagement_SActiveInactive.caption as CategoryStatus,
cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,
cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,
cusMDataManagement_ResponseStatus.name as ERICAStatus,
cusCalenManagement_ReportingPeriod.name as ReportingYear,
cusMDataManagement_PSISegment.name as Segment,
cusMDataManagement_PSIProductType.name as ProductType,
StartYear.name as ProgramStartYear,
EndYear.name as ProgramEndYear,
cusMDataManagement_PSIProgram.name as Program,
--Risk Information
EHSCurrentRisk.name as EHSCurrentRisk,
LaborCurrentRisk.name as LaborCurrentRisk,
EHSOnsiteAssess.name as EHSOnsiteAssess,
cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,
LaborOnsiteAssess.name as LaborOnsiteAssess,
cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,
cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,
cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,
cusExSupplyTracker_ExSupplyTracker.EcovadisDate,
ReassessYear.name as ReassessYear,
cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,
cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,
cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,
cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,
cusExSupplyTracker_ExSupplyTracker.JJStatus,
--Fire Safety
cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,
cusexsupplytracker_infosource.name as InformationSource,
cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,
cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,
cusexsupplytracker_hydrantsystem.value as HydrantSystem,
cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,
cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,
cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,
cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther

from jjcurve_t.cusExSupplyTracker_ExternaSupplier
left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id
left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id
left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID
left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id
left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID
left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id
left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID
left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id
left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID
left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id
left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID
left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id
left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id
left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id
left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID
left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id
left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id
left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id
left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID
left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id
left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id
left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id
left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id
left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id
left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID
left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id
left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id
left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id
left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id
left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id
left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id
left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id
left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id
left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id
left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id
left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id
left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id
left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id
left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id
left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id
left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id

where cusExSupplyTracker_ExternaSupplier.deleted=0</File>
          <FormatSpecificOptions>
            <PreSQL />
            <PreSQLOnConfig>True</PreSQLOnConfig>
            <NoProgress>True</NoProgress>
            <SessionReadOnly>True</SessionReadOnly>
            <CacheData>False</CacheData>
            <TableStyle>Quoted</TableStyle>
            <ReadUncommitted>False</ReadUncommitted>
            <PostSQL />
          </FormatSpecificOptions>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <AnnotationText>External Supply Tracker</AnnotationText>
          <DefaultAnnotationText>DSN=Amazon Redshift Curve
Query=select 
cusExSupplyTracker_...</DefaultAnnotationText>
          <Left value="False" />
        </Annotation>
        <MetaInfo connection="Output">
          <RecordInfo>
            <Field name="id" size="108" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="suppliername" size="1500" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="supplierid" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="Int64" />
            <Field name="ecovadisid" size="60" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="cdpid" size="60" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="smdrericaid" size="60" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="smdmodifieddate" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="DateTime" />
            <Field name="supplierparent" size="600" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="address" size="150" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="city" size="150" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="country" size="12000" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="buyerregion" size="8192" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="supplierregion" size="8192" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="sector" size="150" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="curveid" size="150" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="ecomodifieddate" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="DateTime" />
            <Field name="cdpmodifieddate" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="DateTime" />
            <Field name="scorecard" size="8192" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="scorecardbusinessunit" size="8192" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="rollupsector" size="150" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="categoryfamily" size="8192" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="externalsupplycategory" size="8192" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="primarycategory" size="3" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="spend" scale="4" size="21" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="FixedDecimal" />
            <Field name="categorystatus" size="8192" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="businessunit" size="8192" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="primaryplatform" size="8192" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="ericastatus" size="8192" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="reportingyear" size="747" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="segment" size="8192" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="producttype" size="8192" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="programstartyear" size="8192" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="programendyear" size="8192" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="program" size="8192" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="ehscurrentrisk" size="8192" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="laborcurrentrisk" size="8192" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="ehsonsiteassess" size="8192" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="onassessehsdate" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="DateTime" />
            <Field name="laboronsiteassess" size="8192" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="ethicslabordate" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="DateTime" />
            <Field name="pieamrrisk" size="8192" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="ecovatotalscore" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="Int64" />
            <Field name="ecovadisdate" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="DateTime" />
            <Field name="reassessyear" size="8192" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="ecovadiscoreenv" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="Int64" />
            <Field name="ecovadiscorelab" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="Int64" />
            <Field name="ecovadiscorefbp" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="Int64" />
            <Field name="ecovadiscoresup" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="Int64" />
            <Field name="jjstatus" size="1500" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="firesafetydate" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="DateTime" />
            <Field name="informationsource" size="90" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="automatedfiredetectionandalarmsystem" size="90" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="automatedfiresuppressionsystem" size="90" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="hydrantsystem" size="90" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="twomeansofegress" size="90" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="commentsehssteam" size="8192" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="commentsfiresafety" size="8192" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
            <Field name="commentsother" size="8192" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||select &#xA;cusExSupplyTracker_ExternaSupplier.id,&#xA;cusExSupplyTracker_ExternaSupplier.Name as SupplierName,&#xA;cusExSupplyTracker_ExternaSupplier.RecordNo as SupplierID,&#xA;cusExSupplyTracker_ExternaSupplier.EcovadisID,&#xA;cusExSupplyTracker_ExternaSupplier.CdpID,&#xA;cusexsupplytracker_externasupplier.smdrericaid,&#xA;cusexsupplytracker_externasupplier.smdmodifieddate,&#xA;cusExSupplyTracker_ExternaSupplier.SupplierParent,&#xA;cusExSupplyTracker_ExternaSupplier.Address,&#xA;cusExSupplyTracker_ExternaSupplier.City,&#xA;cusMDataManagement_Countries.caption as Country,&#xA;BuyerRegion.caption as BuyerRegion,&#xA;SupplierRegion.caption as SupplierRegion,&#xA;cusMDataManagement_Sectors.name as Sector,&#xA;cusExSupplyTracker_ExternaSupplier.CurveID,&#xA;cusExSupplyTracker_ExternaSupplier.EcoModifiedDate,&#xA;cusExSupplyTracker_ExternaSupplier.CDPModifiedDate,&#xA;cusMDataManagement_SuppliScorecard.Scorecard,&#xA;scorecardbusinessunit.name as ScorecardBusinessUnit,&#xA;RollupSector.name as rollupsector,&#xA;cusMDataManagement_Pcategoryfamily.name as CategoryFamily,&#xA;cusMDataManagement_PSICategory.name as ExternalSupplyCategory,&#xA;case when cusExSupplyTracker_Category.IsPrimary = 1 then 'Yes' when  cusExSupplyTracker_Category.IsPrimary = 0 then 'No' else null end as PrimaryCategory,&#xA;cusExSupplyTracker_Category.spend,&#xA;cusMDataManagement_SActiveInactive.caption as CategoryStatus,&#xA;cusMDataManagement_PSIBusinessUnit.name as BusinessUnit,&#xA;cusMDataManagement_PrimaryPlatform.name as PrimaryPlatform,&#xA;cusMDataManagement_ResponseStatus.name as ERICAStatus,&#xA;cusCalenManagement_ReportingPeriod.name as ReportingYear,&#xA;cusMDataManagement_PSISegment.name as Segment,&#xA;cusMDataManagement_PSIProductType.name as ProductType,&#xA;StartYear.name as ProgramStartYear,&#xA;EndYear.name as ProgramEndYear,&#xA;cusMDataManagement_PSIProgram.name as Program,&#xA;--Risk Information&#xA;EHSCurrentRisk.name as EHSCurrentRisk,&#xA;LaborCurrentRisk.name as LaborCurrentRisk,&#xA;EHSOnsiteAssess.name as EHSOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.OnAssessEHSDate,&#xA;LaborOnsiteAssess.name as LaborOnsiteAssess,&#xA;cusExSupplyTracker_ExSupplyTracker.EthicsLabordate,&#xA;cusPSITracker_Pharmaceuticals.name as PIEAMRRisk,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovaTotalScore,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadisDate,&#xA;ReassessYear.name as ReassessYear,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreENV,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreLAB,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreFBP,&#xA;cusExSupplyTracker_ExSupplyTracker.EcovadiScoreSUP,&#xA;cusExSupplyTracker_ExSupplyTracker.JJStatus,&#xA;--Fire Safety&#xA;cusExSupplyTracker_ExSupplyTracker.FireSafetyDate,&#xA;cusexsupplytracker_infosource.name as InformationSource,&#xA;cusexsupplytracker_autofiredasys.value as AutomatedFireDetectionAndAlarmSystem,&#xA;cusexsupplytracker_autofiresupsys.value as AutomatedFireSuppressionSystem,&#xA;cusexsupplytracker_hydrantsystem.value as HydrantSystem,&#xA;cusexsupplytracker_mainsofegress.value as TwoMeansOfEgress,&#xA;cusExSupplyTracker_ExSupplyTracker.CommentEHSSteam as CommentsEHSSTeam,&#xA;cusExSupplyTracker_ExSupplyTracker.CommEthicsLabor as CommentsFireSafety,&#xA;cusExSupplyTracker_ExSupplyTracker.Ccategorymember as CommentsOther&#xA;&#xA;from jjcurve_t.cusExSupplyTracker_ExternaSupplier&#xA;left join jjcurve_t.cusMDataManagement_Countries on cusExSupplyTracker_ExternaSupplier.CountryID=cusMDataManagement_Countries.id&#xA;left join jjcurve_t.cusMDataManagement_USStates on cusExSupplyTracker_ExternaSupplier.USStateID=cusMDataManagement_USStates.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as BuyerRegion on cusExSupplyTracker_ExternaSupplierBuyerRegionToMDataManagement_RegionMap.regionid=BuyerRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Region as SupplierRegion on cusExSupplyTracker_ExternaSupplierSupplierRegionToMDataManagement_RegionMap.regionid=SupplierRegion.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_Sectors on cusExSupplyTracker_ExternaSupplierSectorToMDataManagement_SectorsMap.SectorsID=cusMDataManagement_Sectors.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_SuppliScorecard on cusExSupplyTracker_ExternaSupplierSuppliScorecardToMDataManagement_SuppliScorecardMap.SuppliScorecardID=cusMDataManagement_SuppliScorecard.id&#xA;left join jjcurve_t.cusExSupplyTracker_Category on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_Category.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PCategoryfamily on cusExSupplyTracker_Category.CategoryFamilyID=cusMDataManagement_PCategoryfamily.id&#xA;left join jjcurve_t.cusMDataManagement_PSICategory on cusExSupplyTracker_Category.ESupplyCategoryID=cusMDataManagement_PSICategory.id&#xA;left join jjcurve_t.cusMDataManagement_SActiveInactive on cusExSupplyTracker_Category.CategGridStatusID=cusMDataManagement_SActiveInactive.id&#xA;left join jjcurve_t.cusExSupplyTracker_BusinessUnit on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_BusinessUnit.ExternaSupplierID&#xA;left join jjcurve_t.cusMDataManagement_PSIBusinessUnit on cusExSupplyTracker_BusinessUnit.NameID=cusMDataManagement_PSIBusinessUnit.id&#xA;left join jjcurve_t.cusMDataManagement_PrimaryPlatform on cusExSupplyTracker_BusinessUnit.PrimaryPlatformID=cusMDataManagement_PrimaryPlatform.id&#xA;left join jjcurve_t.cusMDataManagement_ResponseStatus on cusExSupplyTracker_BusinessUnit.ERICAStatusID=cusMDataManagement_ResponseStatus.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTracker on cusExSupplyTracker_ExternaSupplier.id=cusExSupplyTracker_ExSupplyTracker.ExternaSupplierID&#xA;left join jjcurve_t.cusCalenManagement_ReportingPeriod on cusExSupplyTracker_ExSupplyTracker.ReportingPeriodID=cusCalenManagement_ReportingPeriod.id&#xA;left join jjcurve_t.cusMDataManagement_PSISegment on cusExSupplyTracker_ExSupplyTracker.SegmentID=cusMDataManagement_PSISegment.id&#xA;left join jjcurve_t.cusMDataManagement_PSIProductType on cusExSupplyTracker_ExSupplyTracker.ProductTypeID = cusMDataManagement_PSIProductType.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as StartYear on cusExSupplyTracker_ExSupplyTracker.StartYeaID=StartYear.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as EndYear on cusExSupplyTracker_ExSupplyTracker.ENDYeaID=EndYear.id&#xA;left join jjcurve_t.cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap on cusExSupplyTracker_ExSupplyTracker.id=cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.ExSupplyTrackerID&#xA;left join jjcurve_t.cusMDataManagement_PSIProgram on cusExSupplyTracker_ExSupplyTrackerMultiProgramToMDataManagement_PSIProgramMap.PSIProgramID=cusMDataManagement_PSIProgram.id&#xA;left join jjcurve_t.sysemployee as ProcurementContact on cusExSupplyTracker_ExSupplyTracker.ProcurEMContactID=ProcurementContact.id&#xA;left join jjcurve_t.sysemployee as EHSContact on cusExSupplyTracker_ExSupplyTracker.EHSSContactID=EHSContact.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as EHSCurrentRisk on cusExSupplyTracker_ExSupplyTracker.EHScurrentriskID=EHSCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_PSICurrentRisk as LaborCurrentRisk on cusExSupplyTracker_ExSupplyTracker.LabocurrentriskID=LaborCurrentRisk.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as EHSOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.AssessResultEHSID=EHSOnsiteAssess.id&#xA;left join jjcurve_t.cusMDataManagement_OnsAssessResult as LaborOnsiteAssess on cusExSupplyTracker_ExSupplyTracker.ResuEthicsLaborID=LaborOnsiteAssess.id&#xA;left join jjcurve_t.cusPSITracker_Pharmaceuticals on cusExSupplyTracker_ExSupplyTracker.PharmaceuticalsID=cusPSITracker_Pharmaceuticals.id&#xA;left join jjcurve_t.cusMDataManagement_PSIYear as ReassessYear on cusExSupplyTracker_ExSupplyTracker.ReassessDueYearID=ReassessYear.id&#xA;left join jjcurve_t.cusmdatamanagement_sectors as RollupSector on cusMDataManagement_SuppliScorecard.rollupsectorid = RollupSector.id&#xA;left join jjcurve_t.cusmdatamanagement_psibusinessunit as scorecardbusinessunit on cusmdatamanagement_suppliscorecard.businessunitid = scorecardbusinessunit.id&#xA;left join jjcurve_t.cusexsupplytracker_infosource on cusExSupplyTracker_ExSupplyTracker.InfoSourceid = cusexsupplytracker_infosource.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiredasys on cusExSupplyTracker_ExSupplyTracker.AutoFireDASysid = cusexsupplytracker_autofiredasys.id&#xA;left join jjcurve_t.cusexsupplytracker_autofiresupsys on cusExSupplyTracker_ExSupplyTracker.AutoFireSupSysid = cusexsupplytracker_autofiresupsys.id&#xA;left join jjcurve_t.cusexsupplytracker_hydrantsystem on cusExSupplyTracker_ExSupplyTracker.HydrantSystemid = cusexsupplytracker_hydrantsystem.id&#xA;left join jjcurve_t.cusexsupplytracker_mainsofegress on cusExSupplyTracker_ExSupplyTracker.MainsOfEgressid = cusexsupplytracker_mainsofegress.id&#xA;&#xA;where cusExSupplyTracker_ExternaSupplier.deleted=0" type="V_WString" />
          </RecordInfo>
        </MetaInfo>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxDbFileInput" />
    </Node>
    <Node ToolID="2">
      <GuiSettings Plugin="AlteryxBasePluginsGui.DbFileInput.DbFileInput">
        <Position x="54" y="343" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Passwords>4D2E9A25A7E15EA6BA42A55A819B788885FAB3AB9BE53668A17CB42D45EE5BEB2C6F3</Passwords>
          <File RecordLimit="" FileFormat="23">odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit
select Audit.*,Finding.*,CAPA.* from
(Select
cusAuwithChecklist_AuditChecklists.id as AuditID,
cusclf_checklistanswer.recordno as AuditRecordNo,
auditcompany.caption as CompanyName,
auditcompanyassoc.nodeid as NodeID,
syslocation.name as Property,
syslocation.locationcode as PropertyCode,
cusclf_checklisttype.name as AuditType,
cusauwithchecklist_auditsubtype.subtype as AuditSubType,
cusclf_checkliabstract.title as AuditChecklist,
currentAuditStatus.Name as AuditWorkflowCurrentStatus,
currentAuditstage.name as AuditWorkflowCurrentStage,
cusehsincidentmang_sitelocation.name as SiteLocation,
cusehsincidentmang_ehsdepartment.departmentname as Department,
cusAuwithChecklist_AuditChecklists.startdate as AuditDate,
Auditor.fullname as Auditor,
cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,
SiteLeader.fullname as SiteLeader,
EHSLeader.fullname as EHSLeader,
CampusEHSDirector.fullname as CampusEHSDirector,
RegionalEHSLeader.fullname as RegionalEHSLeader,
SPOC.fullname as SPOC,
EnterprisePSLeader.fullname as EnterprisePSLeader,
SegmentPSLeader.fullname as SegmentPSLeader,
BusinessPSLeader.fullname as BusinessPSLeader,
cusactionplans_auditcapastatus.value as AuditCAPAStatus,
cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,
cusclf_checklistanswer.externsupplier2id as externalsupplierID


from jjcurve_t.cusAuwithChecklist_AuditChecklists
left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id
left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id
left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id
left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id
left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id
left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id
left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id
left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id
left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id
left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id
left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id
left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id
left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id
left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id
left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id
left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id
left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id
left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id


left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid
left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id
left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id
left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id

left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id
left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id

where cusclf_checklistanswer.deleted = 0
and cusclf_checklisttype.name ='External Supply'

) Audit

Left Join
--Finding
(Select 
cusCLF_InsAudFinding.id as FindingID,
cuseventfwk_eventscenario.Recordno as FindingRecordNo,
cusCLF_FindingStatus.name as FindingStatus,
cusCLF_InsAudFinding.DateClosed as DateFindingClosed,
cuseventfwk_eventscenario.description as FindingDescription,
cusehsincidentmang_jjseverity.caption as FindingPriority,
cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,
cusehsincidentmang_sitelocation.name as FindingSiteLocation,
cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,
Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,
Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,
cusCLF_InsAudFinding.standareference as jnjStandardReference,
cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,
cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,
cusCLF_InsAudFinding.reference as Reference

from 
jjcurve_t.cusCLF_InsAudFinding
left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id
left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id
left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id
left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id
left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id

where cuseventfwk_eventscenario.deleted = 0
) Finding


on Audit.AuditID=Finding.FindingAuditID

Left Join
--CAPA
(select 
cusfragapplication_abcorrectivacti.id as CAPAID,
cusCLF_InsActionPlan.findrecordno,
cusfragapplication_abcorrectivacti.datecreated as DateCreated,
Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,
cusfragapplication_abcorrectivacti.actionno as ActionNo,
sysWorkflowStatus.name as CAPACurrentWorkflowStatus,
SysWorkflowStage.name as CAPACurrentWorkflowStage,
cusehsincidentmang_sitelocation.name as CAPASiteLocation,
cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,
cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,
cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,
cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,
ActionOwner.fullname as ActionOwner,
ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,
cuseventfwk_jjcapapriority.caption as Priority,
cusehsincidentmang_yesno.caption as RequiresExtensionApproval,
cusfragapplication_abcorrectivacti.duedate as TargetDate,
cusactionplans_jjcapacontrol.name as CAPAControlType,
cusCLF_InsActionPlan.comments as CAPAComments,
cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,
cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,
CompletedBy.fullname as CompletedBy,
cusfragapplication_abcorrectivacti.completiondate as CompletionDate,
cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason


from jjcurve_t.cusfragapplication_abcorrectivacti
left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id
left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id
left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id
left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id
left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id
left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)
left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID
left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id
left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id
left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id
left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id
left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id
left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id
left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id

where cusfragapplication_abcorrectivacti.deleted = 0
) CAPA

on Finding.FindingRecordNo=CAPA.findrecordno


Union
--Standalone CAPA
select 
null as AuditID,
null as AuditRecordNo,
null as CompanyName,
null as NodeID,
null as Property,
null as PropertyCode,
'Standalone CAPA' as AuditType,
'Standalone CAPA' as AuditSubType,
'Standalone CAPA' as AuditChecklist,
'Standalone CAPA'  as AuditWorkflowCurrentStatus,
'Standalone CAPA'  as AuditWorkflowCurrentStage,
null as SiteLocation,
null as Department,
null as AuditDate,
null as Auditor,
null as ThirdPartyAuditors,
null as SiteLeader,
null as EHSLeader,
null as CampusEHSDirector,
null as RegionalEHSLeader,
null as SPOC,
null as EnterprisePSLeader,
null as SegmentPSLeader,
null as BusinessPSLeader,
null as AuditCAPAStatus,
null as AuditClosingDate,
cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,
cusfragapplication_abcorrectivacti.id as FindingID,
null as FindingRecordNo,
sysWorkflowStatus.name as FindingStatus,
cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,
null as FindingDescription,
cuseventfwk_jjcapapriority.caption as FindingPriority,
null as FindingAuditID,
null as FindingSiteLocation,
null as FindingDepartment,
null as FindingRepeated,
null as FindingRegulatoryNonCompliance,
null as jnjStandardReference,
null as CloseWithoutCAPA,
null as CloseWithoutCAPAComments,
null as Reference,
cusfragapplication_abcorrectivacti.id as CAPAID,
null findrecordno,
cusfragapplication_abcorrectivacti.datecreated as DateCreated,
Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,
cusfragapplication_abcorrectivacti.actionno as ActionNo,
sysWorkflowStatus.name as CAPACurrentWorkflowStatus,
SysWorkflowStage.name as CAPACurrentWorkflowStage,
cusehsincidentmang_sitelocation.name as CAPASiteLocation,
cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,
cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,
cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,
cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,
ActionOwner.fullname as ActionOwner,
ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,
cuseventfwk_jjcapapriority.caption as Priority,
cusehsincidentmang_yesno.caption as RequiresExtensionApproval,
cusfragapplication_abcorrectivacti.duedate as TargetDate,
cusactionplans_jjcapacontrol.name as CAPAControlType,
cuseventfwk_eventactionplan.comments as CAPAComments,
cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,
cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,
CompletedBy.fullname as CompletedBy,
cusfragapplication_abcorrectivacti.completiondate as CompletionDate,
cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason

from jjcurve_t.cusfragapplication_abcorrectivacti
left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id
left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id
left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id
left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id
left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id
left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id
left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)
left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID
left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id
left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id
left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id
left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id
left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id
left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id
left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id
left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id

where cusfragapplication_abcorrectivacti.deleted = 0
and cusfragapplication_abcorrectivacti.capamasterrec =0
and cusactionplans_jjcapasource.name like '%External Supply%'
--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')</File>
          <FormatSpecificOptions>
            <PreSQL />
            <PreSQLOnConfig>True</PreSQLOnConfig>
            <NoProgress>True</NoProgress>
            <SessionReadOnly>True</SessionReadOnly>
            <CacheData>False</CacheData>
            <TableStyle>Quoted</TableStyle>
            <ReadUncommitted>False</ReadUncommitted>
            <PostSQL />
          </FormatSpecificOptions>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <AnnotationText>External Supply Audit/CAPA</AnnotationText>
          <DefaultAnnotationText>DSN=Amazon Redshift Curve
Query=-- External Supply Audit
se...</DefaultAnnotationText>
          <Left value="False" />
        </Annotation>
        <MetaInfo connection="Output">
          <RecordInfo>
            <Field name="auditid" size="108" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="auditrecordno" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="Int64" />
            <Field name="companyname" size="450" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="nodeid" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="Int64" />
            <Field name="property" size="750" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="propertycode" size="600" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="audittype" size="600" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="auditsubtype" size="765" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="auditchecklist" size="600" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="auditworkflowcurrentstatus" size="300" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="auditworkflowcurrentstage" size="300" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="sitelocation" size="36864" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="department" size="36864" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="auditdate" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="DateTime" />
            <Field name="auditor" size="1500" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="thirdpartyauditors" size="9000" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="siteleader" size="1500" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="ehsleader" size="1500" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="campusehsdirector" size="1500" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="regionalehsleader" size="1500" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="spoc" size="1500" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="enterprisepsleader" size="1500" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="segmentpsleader" size="1500" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="businesspsleader" size="1500" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="auditcapastatus" size="36864" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="auditclosingdate" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="DateTime" />
            <Field name="externalsupplierid" size="108" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="findingid" size="108" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="findingrecordno" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="Int64" />
            <Field name="findingstatus" size="750" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="datefindingclosed" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="DateTime" />
            <Field name="findingdescription" size="36864" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="findingpriority" size="36864" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="findingauditid" size="108" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="findingsitelocation" size="36864" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="findingdepartment" size="36864" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="findingrepeated" size="3" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="findingregulatorynoncompliance" size="3" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="jnjstandardreference" size="8192" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="closewithoutcapa" size="1" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="closewithoutcapacomments" size="8192" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="reference" size="6000" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="capaid" size="108" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="findrecordno" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="Int64" />
            <Field name="datecreated" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="DateTime" />
            <Field name="capaassigned" size="3" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="actionno" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="Int64" />
            <Field name="capacurrentworkflowstatus" size="300" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="capacurrentworkflowstage" size="300" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="capasitelocation" size="36864" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="capasubsitelocation" size="600" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="capadepartment" size="36864" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="capasubdepartment" size="600" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="actionrequired" size="16384" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="actionowner" size="1500" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="actionownerreportinghierarchy" size="8192" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="priority" size="36864" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="requiresextensionapproval" size="36864" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="targetdate" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="DateTime" />
            <Field name="capacontroltype" size="64512" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="capacomments" size="36864" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="completioncomments" size="16384" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="describeactionscompleted" size="16384" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="completedby" size="1500" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
            <Field name="completiondate" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="DateTime" />
            <Field name="extensionreason" size="16384" source="File: odbc:DSN=Amazon Redshift Curve;UID=curve_sa_ehss;PWD=__EncPwd1__|||-- External Supply Audit&#xA;select Audit.*,Finding.*,CAPA.* from&#xA;(Select&#xA;cusAuwithChecklist_AuditChecklists.id as AuditID,&#xA;cusclf_checklistanswer.recordno as AuditRecordNo,&#xA;auditcompany.caption as CompanyName,&#xA;auditcompanyassoc.nodeid as NodeID,&#xA;syslocation.name as Property,&#xA;syslocation.locationcode as PropertyCode,&#xA;cusclf_checklisttype.name as AuditType,&#xA;cusauwithchecklist_auditsubtype.subtype as AuditSubType,&#xA;cusclf_checkliabstract.title as AuditChecklist,&#xA;currentAuditStatus.Name as AuditWorkflowCurrentStatus,&#xA;currentAuditstage.name as AuditWorkflowCurrentStage,&#xA;cusehsincidentmang_sitelocation.name as SiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as Department,&#xA;cusAuwithChecklist_AuditChecklists.startdate as AuditDate,&#xA;Auditor.fullname as Auditor,&#xA;cusAuwithChecklist_AuditChecklists.thpartyauditors as ThirdPartyAuditors,&#xA;SiteLeader.fullname as SiteLeader,&#xA;EHSLeader.fullname as EHSLeader,&#xA;CampusEHSDirector.fullname as CampusEHSDirector,&#xA;RegionalEHSLeader.fullname as RegionalEHSLeader,&#xA;SPOC.fullname as SPOC,&#xA;EnterprisePSLeader.fullname as EnterprisePSLeader,&#xA;SegmentPSLeader.fullname as SegmentPSLeader,&#xA;BusinessPSLeader.fullname as BusinessPSLeader,&#xA;cusactionplans_auditcapastatus.value as AuditCAPAStatus,&#xA;cusAuwithChecklist_AuditChecklists.audiclosingdate as AuditClosingDate,&#xA;cusclf_checklistanswer.externsupplier2id as externalsupplierID&#xA;&#xA;&#xA;from jjcurve_t.cusAuwithChecklist_AuditChecklists&#xA;left join jjcurve_t.cusclf_checklistanswer on cusAuwithChecklist_AuditChecklists.id=cusclf_checklistanswer.id&#xA;left join jjcurve_t.syslocation on cusclf_checklistanswer.locationid=syslocation.id&#xA;left join jjcurve_t.cusinsp_inspectionabs on cusAuwithChecklist_AuditChecklists.id=cusinsp_inspectionabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusAuwithChecklist_AuditChecklists.sitelocationid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusAuwithChecklist_AuditChecklists.departmentid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.sysemployee as Auditor on cusAuwithChecklist_AuditChecklists.auditorsid = Auditor.id&#xA;left join jjcurve_t.sysemployee as SiteLeader on cusAuwithChecklist_AuditChecklists.siteleaderid = SiteLeader.id&#xA;left join jjcurve_t.sysemployee as EHSLeader on cusAuwithChecklist_AuditChecklists.ehsleaderid = EHSLeader.id&#xA;left join jjcurve_t.sysemployee as CampusEHSDirector on cusAuwithChecklist_AuditChecklists.campusdirectorid = CampusEHSDirector.id&#xA;left join jjcurve_t.sysemployee as RegionalEHSLeader on cusAuwithChecklist_AuditChecklists.globalehsleaderid = RegionalEHSLeader.id&#xA;left join jjcurve_t.sysemployee as SPOC on cusAuwithChecklist_AuditChecklists.spocid = SPOC.id&#xA;left join jjcurve_t.sysemployee as EnterprisePSLeader on cusAuwithChecklist_AuditChecklists.enterprpsleaderid = EnterprisePSLeader.id&#xA;left join jjcurve_t.sysemployee as SegmentPSLeader on cusAuwithChecklist_AuditChecklists.segmentpsleaderid = SegmentPSLeader.id&#xA;left join jjcurve_t.sysemployee as BusinessPSLeader on cusAuwithChecklist_AuditChecklists.businespsleaderid = BusinessPSLeader.id&#xA;left join jjcurve_t.cusactionplans_auditcapastatus on cusAuwithChecklist_AuditChecklists.auditcapastatusid=cusactionplans_auditcapastatus.id&#xA;left join jjcurve_t.cusclf_checklisttype on cusinsp_inspectionabs.typeofauditid = cusclf_checklisttype.id&#xA;left join jjcurve_t.cusauwithchecklist_auditsubtype on cusinsp_inspectionabs.auditsubtypeid = cusauwithchecklist_auditsubtype.id&#xA;left join jjcurve_t.cusclf_checkliabstract on cusinsp_inspectionabs.auditchecklistid = cusclf_checkliabstract.id&#xA;&#xA;&#xA;left join jjcurve_t.sysworkflowinstance as AuditWorkflowInstance on cusAuwithChecklist_AuditChecklists.id=AuditWorkflowInstance.entityid&#xA;left join jjcurve_t.SysWorkflowStage as currentAuditstage on AuditWorkflowInstance.CurrentStageID = currentAuditstage.Id&#xA;left join jjcurve_t.sysemployee as AuditPersonResponsible on AuditWorkflowInstance.createdbyid = AuditPersonResponsible.Id&#xA;left join jjcurve_t.sysWorkflowStatus as currentAuditStatus on AuditWorkflowInstance.StatusId = currentAuditStatus.Id&#xA;&#xA;left join jjcurve_t.cusehsmasterprofil_ehsloccomassoc as auditcompanyassoc on cusAuwithChecklist_AuditChecklists.companyauditid = auditcompanyassoc.id&#xA;left join jjcurve_t.cusmdatamanagement_companylist as auditcompany on auditcompanyassoc.companyid = auditcompany.id&#xA;&#xA;where cusclf_checklistanswer.deleted = 0&#xA;and cusclf_checklisttype.name ='External Supply'&#xA;&#xA;) Audit&#xA;&#xA;Left Join&#xA;--Finding&#xA;(Select &#xA;cusCLF_InsAudFinding.id as FindingID,&#xA;cuseventfwk_eventscenario.Recordno as FindingRecordNo,&#xA;cusCLF_FindingStatus.name as FindingStatus,&#xA;cusCLF_InsAudFinding.DateClosed as DateFindingClosed,&#xA;cuseventfwk_eventscenario.description as FindingDescription,&#xA;cusehsincidentmang_jjseverity.caption as FindingPriority,&#xA;cusCLF_InsAudFinding.iachecklistansid as FindingAuditID,&#xA;cusehsincidentmang_sitelocation.name as FindingSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as FindingDepartment,&#xA;Case cusCLF_InsAudFinding.repeatedfinding when 1 then 'Yes' when 0 then 'No' end as FindingRepeated,&#xA;Case cusCLF_InsAudFinding.regnoncomp when 1 then 'Yes' when 0 then 'No' end as FindingRegulatoryNonCompliance,&#xA;cusCLF_InsAudFinding.standareference as jnjStandardReference,&#xA;cusCLF_InsAudFinding.manualclose as CloseWithoutCAPA,&#xA;cusCLF_InsAudFinding.manclosecom as CloseWithoutCAPAComments,&#xA;cusCLF_InsAudFinding.reference as Reference&#xA;&#xA;from &#xA;jjcurve_t.cusCLF_InsAudFinding&#xA;left join jjcurve_t.cuseventfwk_eventscenario on cusCLF_InsAudFinding.id=cuseventfwk_eventscenario.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusCLF_InsAudFinding.audsitelocid=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusCLF_InsAudFinding.auddepartmid=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusCLF_FindingStatus on cusCLF_InsAudFinding.findingstatusid=cusCLF_FindingStatus.id&#xA;left join jjcurve_t.cusehsincidentmang_jjseverity on cusCLF_InsAudFinding.auditpriorityid=cusehsincidentmang_jjseverity.id&#xA;&#xA;where cuseventfwk_eventscenario.deleted = 0&#xA;) Finding&#xA;&#xA;&#xA;on Audit.AuditID=Finding.FindingAuditID&#xA;&#xA;Left Join&#xA;--CAPA&#xA;(select &#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;cusCLF_InsActionPlan.findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cusCLF_InsActionPlan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cusCLF_InsActionPlan on cusfragapplication_abcorrectivacti.id=cusCLF_InsActionPlan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;) CAPA&#xA;&#xA;on Finding.FindingRecordNo=CAPA.findrecordno&#xA;&#xA;&#xA;Union&#xA;--Standalone CAPA&#xA;select &#xA;null as AuditID,&#xA;null as AuditRecordNo,&#xA;null as CompanyName,&#xA;null as NodeID,&#xA;null as Property,&#xA;null as PropertyCode,&#xA;'Standalone CAPA' as AuditType,&#xA;'Standalone CAPA' as AuditSubType,&#xA;'Standalone CAPA' as AuditChecklist,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStatus,&#xA;'Standalone CAPA'  as AuditWorkflowCurrentStage,&#xA;null as SiteLocation,&#xA;null as Department,&#xA;null as AuditDate,&#xA;null as Auditor,&#xA;null as ThirdPartyAuditors,&#xA;null as SiteLeader,&#xA;null as EHSLeader,&#xA;null as CampusEHSDirector,&#xA;null as RegionalEHSLeader,&#xA;null as SPOC,&#xA;null as EnterprisePSLeader,&#xA;null as SegmentPSLeader,&#xA;null as BusinessPSLeader,&#xA;null as AuditCAPAStatus,&#xA;null as AuditClosingDate,&#xA;cusActionPlans_CAPAsMaster.externsupplier2id as externalsupplierID,&#xA;cusfragapplication_abcorrectivacti.id as FindingID,&#xA;null as FindingRecordNo,&#xA;sysWorkflowStatus.name as FindingStatus,&#xA;cusfragapplication_abcorrectivacti.completiondate as DateFindingClosed,&#xA;null as FindingDescription,&#xA;cuseventfwk_jjcapapriority.caption as FindingPriority,&#xA;null as FindingAuditID,&#xA;null as FindingSiteLocation,&#xA;null as FindingDepartment,&#xA;null as FindingRepeated,&#xA;null as FindingRegulatoryNonCompliance,&#xA;null as jnjStandardReference,&#xA;null as CloseWithoutCAPA,&#xA;null as CloseWithoutCAPAComments,&#xA;null as Reference,&#xA;cusfragapplication_abcorrectivacti.id as CAPAID,&#xA;null findrecordno,&#xA;cusfragapplication_abcorrectivacti.datecreated as DateCreated,&#xA;Case cusfragapplication_abcorrectivacti.actionvalid0 when 1 then 'Yes' when 0 then 'No' end as CAPAAssigned,&#xA;cusfragapplication_abcorrectivacti.actionno as ActionNo,&#xA;sysWorkflowStatus.name as CAPACurrentWorkflowStatus,&#xA;SysWorkflowStage.name as CAPACurrentWorkflowStage,&#xA;cusehsincidentmang_sitelocation.name as CAPASiteLocation,&#xA;cusehsincidentmang_siteloclocal.siteloclocaln as CAPASubSiteLocation,&#xA;cusehsincidentmang_ehsdepartment.departmentname as CAPADepartment,&#xA;cusehsincidentmang_localdepart.localdeptname as CAPASubDepartment,&#xA;cusfragapplication_abcorrectivacti.cparactionreq as ActionRequired,&#xA;ActionOwner.fullname as ActionOwner,&#xA;ActionOwner.treporthiearchy as ActionOwnerReportingHierarchy,&#xA;cuseventfwk_jjcapapriority.caption as Priority,&#xA;cusehsincidentmang_yesno.caption as RequiresExtensionApproval,&#xA;cusfragapplication_abcorrectivacti.duedate as TargetDate,&#xA;cusactionplans_jjcapacontrol.name as CAPAControlType,&#xA;cuseventfwk_eventactionplan.comments as CAPAComments,&#xA;cusfragapplication_abcorrectivacti.completionnotes as CompletionComments,&#xA;cusfragapplication_abcorrectivacti.actionscomp0 as DescribeActionsCompleted,&#xA;CompletedBy.fullname as CompletedBy,&#xA;cusfragapplication_abcorrectivacti.completiondate as CompletionDate,&#xA;cusfragapplication_abcorrectivacti.extensionreason as ExtensionReason&#xA;&#xA;from jjcurve_t.cusfragapplication_abcorrectivacti&#xA;left join jjcurve_t.cusactionplans_jjcapasource on cusfragapplication_abcorrectivacti.capasource0id=cusactionplans_jjcapasource.id&#xA;left join jjcurve_t.cusactionplans_actionplanabs on cusfragapplication_abcorrectivacti.id=cusactionplans_actionplanabs.id&#xA;left join jjcurve_t.cusehsincidentmang_sitelocation on cusfragapplication_abcorrectivacti.sitelocation0id=cusehsincidentmang_sitelocation.id&#xA;left join jjcurve_t.cusehsincidentmang_ehsdepartment on cusfragapplication_abcorrectivacti.department0id=cusehsincidentmang_ehsdepartment.id&#xA;left join jjcurve_t.cusehsincidentmang_siteloclocal on cusfragapplication_abcorrectivacti.subsitelocationid=cusehsincidentmang_siteloclocal.id&#xA;left join jjcurve_t.cusehsincidentmang_localdepart on cusfragapplication_abcorrectivacti.subdepartmentid=cusehsincidentmang_localdepart.id&#xA;left join jjcurve_t.cuseventfwk_eventactionplan on cusfragapplication_abcorrectivacti.id=cuseventfwk_eventactionplan.id --NOTE THIS IS DIFFERENT THAN EVENT MANAGEMENT (cuseventfwk_eventactionplan)&#xA;left join jjcurve_t.sysWorkflowInstance on cusfragapplication_abcorrectivacti.ID = sysWorkflowInstance.EntityID&#xA;left join jjcurve_t.sysWorkflowStatus on sysWorkflowInstance.StatusId = sysWorkflowStatus.Id&#xA;left join jjcurve_t.SysWorkflowStage on sysWorkflowInstance.CurrentStageID = SysWorkflowStage.Id&#xA;left join jjcurve_t.sysemployee as ActionOwner on cusfragapplication_abcorrectivacti.personresp0id = ActionOwner.id&#xA;left join jjcurve_t.cuseventfwk_jjcapapriority on cusfragapplication_abcorrectivacti.priority0id = cuseventfwk_jjcapapriority.id&#xA;left join jjcurve_t.cusehsincidentmang_yesno on cusfragapplication_abcorrectivacti.rqrsextnsnaprvlid = cusehsincidentmang_yesno.id&#xA;left join jjcurve_t.cusactionplans_jjcapacontrol on cusfragapplication_abcorrectivacti.capacontroltypeid = cusactionplans_jjcapacontrol.Id&#xA;left join jjcurve_t.sysemployee as CompletedBy on cusfragapplication_abcorrectivacti.completedbyid = CompletedBy.id&#xA;left join jjcurve_t.cusActionPlans_CAPAsMaster on cusfragapplication_abcorrectivacti.capasmasterlinkid=cusActionPlans_CAPAsMaster.id&#xA;&#xA;where cusfragapplication_abcorrectivacti.deleted = 0&#xA;and cusfragapplication_abcorrectivacti.capamasterrec =0&#xA;and cusactionplans_jjcapasource.name like '%External Supply%'&#xA;--and (cuseventfwk_jjcapapriority.caption = 'Critical' or cuseventfwk_jjcapapriority.caption = 'Major')" type="V_WString" />
          </RecordInfo>
        </MetaInfo>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxDbFileInput" />
    </Node>
    <Node ToolID="3">
      <GuiSettings Plugin="AlteryxBasePluginsGui.Join.Join">
        <Position x="390" y="175" />
      </GuiSettings>
      <Properties>
        <Configuration joinByRecordPos="False">
          <JoinInfo connection="Left">
            <Field field="id" />
          </JoinInfo>
          <JoinInfo connection="Right">
            <Field field="externalsupplierid" />
          </JoinInfo>
          <SelectConfiguration>
            <Configuration outputConnection="Join">
              <OrderChanged value="False" />
              <CommaDecimal value="False" />
              <SelectFields>
                <SelectField field="Right_id" selected="True" rename="Right_id" input="Right_" />
                <SelectField field="*Unknown" selected="True" />
              </SelectFields>
            </Configuration>
          </SelectConfiguration>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxJoin" />
    </Node>
    <Node ToolID="10">
      <GuiSettings Plugin="AlteryxBasePluginsGui.Union.Union">
        <Position x="522" y="175" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <ByName_ErrorMode>Warning</ByName_ErrorMode>
          <ByName_OutputMode>All</ByName_OutputMode>
          <Mode>ByName</Mode>
          <SetOutputOrder value="False" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxUnion" />
    </Node>
    <Node ToolID="11">
      <GuiSettings Plugin="AlteryxBasePluginsGui.DbFileInput.DbFileInput">
        <Position x="54" y="523" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Passwords />
          <File OutputFileName="" RecordLimit="" SearchSubDirs="False" FileFormat="25">\\awsbsonvaw0000.jnj.com\EHSS\Production\Excel Data Sources Library\External Supply - Supplier Attributes.xlsx|||`External Supply - Supplier Attr$`</File>
          <FormatSpecificOptions>
            <FirstRowData>False</FirstRowData>
            <ImportLine>1</ImportLine>
          </FormatSpecificOptions>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText>External Supply - Supplier Attributes.xlsx
Query=`External Supply - Supplier ...</DefaultAnnotationText>
          <Left value="False" />
        </Annotation>
        <MetaInfo connection="Output">
          <RecordInfo>
            <Field name="External Supplier" size="255" source="File: \\awsbsonvaw0000.jnj.com\EHSS\Production\Excel Data Sources Library\External Supply - Supplier Attributes.xlsx|||`External Supply - Supplier Attr$`" type="V_String" />
            <Field name="Include" size="255" source="File: \\awsbsonvaw0000.jnj.com\EHSS\Production\Excel Data Sources Library\External Supply - Supplier Attributes.xlsx|||`External Supply - Supplier Attr$`" type="V_String" />
            <Field name="Type" size="255" source="File: \\awsbsonvaw0000.jnj.com\EHSS\Production\Excel Data Sources Library\External Supply - Supplier Attributes.xlsx|||`External Supply - Supplier Attr$`" type="V_String" />
            <Field name="Company" size="255" source="File: \\awsbsonvaw0000.jnj.com\EHSS\Production\Excel Data Sources Library\External Supply - Supplier Attributes.xlsx|||`External Supply - Supplier Attr$`" type="V_String" />
            <Field name="F5" source="File: \\awsbsonvaw0000.jnj.com\EHSS\Production\Excel Data Sources Library\External Supply - Supplier Attributes.xlsx|||`External Supply - Supplier Attr$`" type="Double" />
            <Field name="F6" source="File: \\awsbsonvaw0000.jnj.com\EHSS\Production\Excel Data Sources Library\External Supply - Supplier Attributes.xlsx|||`External Supply - Supplier Attr$`" type="Double" />
            <Field name="F7" source="File: \\awsbsonvaw0000.jnj.com\EHSS\Production\Excel Data Sources Library\External Supply - Supplier Attributes.xlsx|||`External Supply - Supplier Attr$`" type="Double" />
            <Field name="F8" source="File: \\awsbsonvaw0000.jnj.com\EHSS\Production\Excel Data Sources Library\External Supply - Supplier Attributes.xlsx|||`External Supply - Supplier Attr$`" type="Double" />
            <Field name="F9" source="File: \\awsbsonvaw0000.jnj.com\EHSS\Production\Excel Data Sources Library\External Supply - Supplier Attributes.xlsx|||`External Supply - Supplier Attr$`" type="Double" />
            <Field name="F10" source="File: \\awsbsonvaw0000.jnj.com\EHSS\Production\Excel Data Sources Library\External Supply - Supplier Attributes.xlsx|||`External Supply - Supplier Attr$`" type="Double" />
            <Field name="F11" source="File: \\awsbsonvaw0000.jnj.com\EHSS\Production\Excel Data Sources Library\External Supply - Supplier Attributes.xlsx|||`External Supply - Supplier Attr$`" type="Double" />
            <Field name="F12" source="File: \\awsbsonvaw0000.jnj.com\EHSS\Production\Excel Data Sources Library\External Supply - Supplier Attributes.xlsx|||`External Supply - Supplier Attr$`" type="Double" />
            <Field name="F13" source="File: \\awsbsonvaw0000.jnj.com\EHSS\Production\Excel Data Sources Library\External Supply - Supplier Attributes.xlsx|||`External Supply - Supplier Attr$`" type="Double" />
            <Field name="F14" source="File: \\awsbsonvaw0000.jnj.com\EHSS\Production\Excel Data Sources Library\External Supply - Supplier Attributes.xlsx|||`External Supply - Supplier Attr$`" type="Double" />
            <Field name="F15" source="File: \\awsbsonvaw0000.jnj.com\EHSS\Production\Excel Data Sources Library\External Supply - Supplier Attributes.xlsx|||`External Supply - Supplier Attr$`" type="Double" />
            <Field name="F16" source="File: \\awsbsonvaw0000.jnj.com\EHSS\Production\Excel Data Sources Library\External Supply - Supplier Attributes.xlsx|||`External Supply - Supplier Attr$`" type="Double" />
            <Field name="F17" source="File: \\awsbsonvaw0000.jnj.com\EHSS\Production\Excel Data Sources Library\External Supply - Supplier Attributes.xlsx|||`External Supply - Supplier Attr$`" type="Double" />
            <Field name="F18" source="File: \\awsbsonvaw0000.jnj.com\EHSS\Production\Excel Data Sources Library\External Supply - Supplier Attributes.xlsx|||`External Supply - Supplier Attr$`" type="Double" />
          </RecordInfo>
        </MetaInfo>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxDbFileInput" />
    </Node>
    <Node ToolID="12">
      <GuiSettings Plugin="AlteryxBasePluginsGui.AlteryxSelect.AlteryxSelect">
        <Position x="210" y="499" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <OrderChanged value="False" />
          <CommaDecimal value="False" />
          <SelectFields>
            <SelectField field="F5" selected="False" />
            <SelectField field="F6" selected="False" />
            <SelectField field="F7" selected="False" />
            <SelectField field="F8" selected="False" />
            <SelectField field="F9" selected="False" />
            <SelectField field="F10" selected="False" />
            <SelectField field="F11" selected="False" />
            <SelectField field="F12" selected="False" />
            <SelectField field="F13" selected="False" />
            <SelectField field="F14" selected="False" />
            <SelectField field="F15" selected="False" />
            <SelectField field="F16" selected="False" />
            <SelectField field="F17" selected="False" />
            <SelectField field="F18" selected="False" />
            <SelectField field="*Unknown" selected="True" />
          </SelectFields>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxSelect" />
    </Node>
    <Node ToolID="13">
      <GuiSettings Plugin="AlteryxBasePluginsGui.Join.Join">
        <Position x="666" y="188" />
      </GuiSettings>
      <Properties>
        <Configuration joinByRecordPos="False">
          <JoinInfo connection="Left">
            <Field field="suppliername" />
          </JoinInfo>
          <JoinInfo connection="Right">
            <Field field="External Supplier" />
          </JoinInfo>
          <SelectConfiguration>
            <Configuration outputConnection="Join">
              <OrderChanged value="False" />
              <CommaDecimal value="False" />
              <SelectFields>
                <SelectField field="*Unknown" selected="True" />
              </SelectFields>
            </Configuration>
          </SelectConfiguration>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxJoin" />
    </Node>
    <Node ToolID="14">
      <GuiSettings Plugin="AlteryxBasePluginsGui.Union.Union">
        <Position x="762" y="187" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <ByName_ErrorMode>Warning</ByName_ErrorMode>
          <ByName_OutputMode>All</ByName_OutputMode>
          <Mode>ByName</Mode>
          <SetOutputOrder value="False" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxUnion" />
    </Node>
    <Node ToolID="24">
      <GuiSettings Plugin="AlteryxBasePluginsGui.BrowseV2.BrowseV2">
        <Position x="474" y="379" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <TempFile>C:\Users\SElango4\AppData\Local\Temp\Engine_19656_ca89cf7da406374189bcbeeabc8cf023_\Engine_19656_ce2a917d0d150046a6a66baf515b1cc4~.yxdb</TempFile>
          <TempFileDataProfiling />
          <Layout>
            <ViewMode>Single</ViewMode>
            <ViewSize value="100" />
            <View1>
              <DefaultTab>Profile</DefaultTab>
              <Hints>
                <Table />
              </Hints>
            </View1>
            <View2 />
          </Layout>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxBrowseV2" />
    </Node>
    <Node ToolID="28">
      <GuiSettings Plugin="AlteryxBasePluginsGui.Formula.Formula">
        <Position x="858" y="187" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <FormulaFields>
            <FormulaField expression="DateTimeNow()" field="External Supply Refresh Date" size="19" type="DateTime" />
          </FormulaFields>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText><![CDATA[External Supply Refresh Date = DateTimeNow()
]]></DefaultAnnotationText>
          <Left value="False" />
        </Annotation>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxFormula" />
    </Node>
    <Node ToolID="29">
      <GuiSettings Plugin="AlteryxBasePluginsGui.BrowseV2.BrowseV2">
        <Position x="198" y="103" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <TempFile>C:\Users\SElango4\AppData\Local\Temp\Engine_19656_ca89cf7da406374189bcbeeabc8cf023_\Engine_19656_006eaf2c0328394396cd97682b16511a~.yxdb</TempFile>
          <TempFileDataProfiling />
          <Layout>
            <ViewMode>Single</ViewMode>
            <ViewSize value="100" />
            <View1>
              <DefaultTab>Profile</DefaultTab>
              <Hints>
                <Table />
              </Hints>
            </View1>
            <View2 />
          </Layout>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxBrowseV2" />
    </Node>
    <Node ToolID="30">
      <GuiSettings Plugin="AlteryxBasePluginsGui.BrowseV2.BrowseV2">
        <Position x="654" y="115" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Layout>
            <View1>
              <Hints>
                <Table />
              </Hints>
            </View1>
          </Layout>
          <TempFile>C:\Users\SElango4\AppData\Local\Temp\Engine_19656_ca89cf7da406374189bcbeeabc8cf023_\Engine_19656_528a2e320f4f1d4894c626c5df15c923~.yxdb</TempFile>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxBrowseV2" />
    </Node>
    <Node ToolID="31">
      <GuiSettings Plugin="AlteryxBasePluginsGui.BrowseV2.BrowseV2">
        <Position x="930" y="67" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <TempFile>C:\Users\SElango4\AppData\Local\Temp\Engine_19656_ca89cf7da406374189bcbeeabc8cf023_\Engine_19656_90327de720b8634c9d1e21ef5017c93c~.yxdb</TempFile>
          <TempFileDataProfiling />
          <Layout>
            <ViewMode>Single</ViewMode>
            <ViewSize value="100" />
            <View1>
              <DefaultTab>Profile</DefaultTab>
              <Hints>
                <Table />
              </Hints>
            </View1>
            <View2 />
          </Layout>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxBrowseV2" />
    </Node>
    <Node ToolID="32">
      <GuiSettings Plugin="AlteryxBasePluginsGui.BrowseV2.BrowseV2">
        <Position x="594" y="499" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <TempFile>C:\Users\SElango4\AppData\Local\Temp\Engine_19656_ca89cf7da406374189bcbeeabc8cf023_\Engine_19656_87b7e3d634d21342999399dced4f897f~.yxdb</TempFile>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxBrowseV2" />
    </Node>
    <Node ToolID="33">
      <GuiSettings Plugin="AlteryxBasePluginsGui.Filter.Filter">
        <Position x="234" y="151" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Expression>country IN  ("China",
"United States Minor Outlying Islands"
)</Expression>
          <Mode>Custom</Mode>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText>country IN  ("China",
"United States Minor Outlying Islands"
)</DefaultAnnotationText>
          <Left value="False" />
        </Annotation>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxFilter" />
    </Node>
    <Node ToolID="34">
      <GuiSettings Plugin="AlteryxBasePluginsGui.BrowseV2.BrowseV2">
        <Position x="378" y="115" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Layout>
            <View1>
              <Hints>
                <Table />
              </Hints>
            </View1>
          </Layout>
          <TempFile>C:\Users\SElango4\AppData\Local\Temp\Engine_19656_ca89cf7da406374189bcbeeabc8cf023_\Engine_19656_8ccf12cc192e8e478c4498bd1bfa839c~.yxdb</TempFile>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxBrowseV2" />
    </Node>
    <Node ToolID="35">
      <GuiSettings Plugin="AlteryxBasePluginsGui.Formula.Formula">
        <Position x="210" y="319" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <FormulaFields>
            <FormulaField expression="IF [auditworkflowcurrentstatus] = 'Open' OR [auditworkflowcurrentstatus] = 'Closed' THEN&#xA;    IF DateTimeDiff([auditdate], [auditclosingdate], 'day') - 1 &lt; 10 THEN&#xA;        [auditid]&#xA;    ELSE&#xA;        NULL()&#xA;    ENDIF&#xA;ELSE&#xA;    NULL()&#xA;ENDIF&#xA;" field="Audit_Date_Calccol" size="1073741823" type="V_WString" />
            <FormulaField expression="Uppercase([companyname])" field="companyname" size="450" type="V_WString" />
          </FormulaFields>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText>Audit_Date_Calccol = IF [auditworkflowcurrentstatus] = 'Open' OR [auditworkflowc...</DefaultAnnotationText>
          <Left value="False" />
        </Annotation>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxFormula" />
    </Node>
    <Node ToolID="36">
      <GuiSettings Plugin="AlteryxBasePluginsGui.BrowseV2.BrowseV2">
        <Position x="378" y="295" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <TempFile>C:\Users\SElango4\AppData\Local\Temp\Engine_19656_ca89cf7da406374189bcbeeabc8cf023_\Engine_19656_74dba0f7bf889c49be13cfd8894c20b3~.yxdb</TempFile>
          <TempFileDataProfiling />
          <Layout>
            <ViewMode>Single</ViewMode>
            <ViewSize value="100" />
            <View1>
              <DefaultTab>Profile</DefaultTab>
              <Hints>
                <Table />
              </Hints>
            </View1>
            <View2 />
          </Layout>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxBrowseV2" />
    </Node>
    <Node ToolID="37">
      <GuiSettings Plugin="AlteryxBasePluginsGui.DbFileOutput.DbFileOutput">
        <Position x="1218" y="391" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <File MaxRecords="" FileFormat="0">C:\Users\SElango4\OneDrive - JNJ\Desktop\Alteryx_sample_output.csv</File>
          <Passwords />
          <Disable>False</Disable>
          <FormatSpecificOptions>
            <LineEndStyle>CRLF</LineEndStyle>
            <Delimeter>,</Delimeter>
            <ForceQuotes>False</ForceQuotes>
            <HeaderRow>True</HeaderRow>
            <CodePage>28591</CodePage>
            <WriteBOM>True</WriteBOM>
          </FormatSpecificOptions>
          <MultiFile value="False" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText>Alteryx_sample_output.csv</DefaultAnnotationText>
          <Left value="False" />
        </Annotation>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxDbFileOutput" />
    </Node>
    <Node ToolID="46">
      <GuiSettings Plugin="AlteryxBasePluginsGui.DbFileOutput.DbFileOutput">
        <Position x="1326" y="295" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <File MaxRecords="" FileFormat="25">C:\Users\SElango4\OneDrive - JNJ\Desktop\Denodo Backup\View Comparision Report - April 4 2024.xlsx|||Sheet2</File>
          <Passwords />
          <Disable>False</Disable>
          <FormatSpecificOptions>
            <PreserveFormat>False</PreserveFormat>
            <SkipFieldNames>False</SkipFieldNames>
            <OutputOption>Create</OutputOption>
          </FormatSpecificOptions>
          <MultiFile value="False" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText>View Comparision Report - April 4 2024.xlsx
Query=Sheet2</DefaultAnnotationText>
          <Left value="False" />
        </Annotation>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxDbFileOutput" />
    </Node>
    <Node ToolID="49">
      <GuiSettings Plugin="AlteryxGuiToolkit.ToolContainer.ToolContainer">
        <Position x="1301" y="54" width="152" height="180" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Caption>Container 49</Caption>
          <Style TextColor="#314c4a" FillColor="#00ff80" BorderColor="#314c4a" Transparency="25" Margin="25" />
          <Disabled value="False" />
          <Folded value="False" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <ChildNodes>
        <Node ToolID="47">
          <GuiSettings Plugin="AlteryxBasePluginsGui.DbFileOutput.DbFileOutput">
            <Position x="1326" y="103" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <File MaxRecords="" FileFormat="25">C:\Users\SElango4\OneDrive - JNJ\Desktop\Migration Release Details\Final Views_New Names.xlsx|||Sheet3</File>
              <Passwords />
              <Disable>False</Disable>
              <FormatSpecificOptions>
                <PreserveFormat>False</PreserveFormat>
                <AppendMap>
                  <AppendMapping mode="ByName" />
                </AppendMap>
                <SkipFieldNames>False</SkipFieldNames>
                <OutputOption>Append</OutputOption>
              </FormatSpecificOptions>
              <MultiFile value="False" />
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <DefaultAnnotationText>Final Views_New Names.xlsx
Query=Sheet3</DefaultAnnotationText>
              <Left value="False" />
            </Annotation>
          </Properties>
          <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxDbFileOutput" />
        </Node>
      </ChildNodes>
    </Node>
    <Node ToolID="48">
      <GuiSettings Plugin="AlteryxGuiToolkit.ControlContainer.ControlContainer">
        <Position x="665" y="449" width="538" height="297" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Caption>Control Container 48</Caption>
          <Style TextColor="#314c4a" FillColor="#e3e8fb" BorderColor="#314c4a" Transparency="25" Margin="25" />
          <Disabled value="False" />
          <Folded value="False" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <ChildNodes>
        <Node ToolID="38">
          <GuiSettings Plugin="AlteryxBasePluginsGui.AlteryxSelect.AlteryxSelect">
            <Position x="690" y="546" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <OrderChanged value="False" />
              <CommaDecimal value="False" />
              <SelectFields>
                <SelectField field="supplierparent" selected="False" />
                <SelectField field="address" selected="False" />
                <SelectField field="city" selected="False" />
                <SelectField field="country" selected="True" rename="Reported Country" />
                <SelectField field="*Unknown" selected="True" />
              </SelectFields>
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <DefaultAnnotationText />
              <Left value="False" />
            </Annotation>
          </Properties>
          <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxSelect" />
        </Node>
        <Node ToolID="39">
          <GuiSettings Plugin="AlteryxSpatialPluginsGui.Summarize.Summarize">
            <Position x="810" y="546" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <SummarizeFields>
                <SummarizeField field="categoryfamily" action="GroupBy" rename="categoryfamily" />
                <SummarizeField field="spend" action="Max" rename="Maximum_Spend" />
              </SummarizeFields>
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <DefaultAnnotationText />
              <Left value="False" />
            </Annotation>
          </Properties>
          <EngineSettings EngineDll="AlteryxSpatialPluginsEngine.dll" EngineDllEntryPoint="AlteryxSummarize" />
        </Node>
        <Node ToolID="40">
          <GuiSettings Plugin="AlteryxBasePluginsGui.DbFileOutput.DbFileOutput">
            <Position x="1062" y="534" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <File MaxRecords="" FileFormat="0">C:\Users\SElango4\OneDrive - JNJ\Desktop\Alteryx_sample_output2.csv</File>
              <Passwords />
              <Disable>False</Disable>
              <FormatSpecificOptions>
                <LineEndStyle>CRLF</LineEndStyle>
                <Delimeter>,</Delimeter>
                <ForceQuotes>False</ForceQuotes>
                <HeaderRow>True</HeaderRow>
                <CodePage>28591</CodePage>
                <WriteBOM>True</WriteBOM>
              </FormatSpecificOptions>
              <MultiFile value="False" />
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <DefaultAnnotationText>Alteryx_sample_output2.csv</DefaultAnnotationText>
              <Left value="False" />
            </Annotation>
          </Properties>
          <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxDbFileOutput" />
        </Node>
        <Node ToolID="41">
          <GuiSettings Plugin="AlteryxBasePluginsGui.Unique.Unique">
            <Position x="762" y="618" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <UniqueFields>
                <Field field="Reported Country" />
              </UniqueFields>
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <DefaultAnnotationText />
              <Left value="False" />
            </Annotation>
          </Properties>
          <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxUnique" />
        </Node>
        <Node ToolID="42">
          <GuiSettings Plugin="AlteryxBasePluginsGui.DbFileOutput.DbFileOutput">
            <Position x="1074" y="630" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <File MaxRecords="" FileFormat="0">C:\Users\SElango4\OneDrive - JNJ\Desktop\Alteryx_sample_output3.csv</File>
              <Passwords />
              <Disable>False</Disable>
              <FormatSpecificOptions>
                <LineEndStyle>CRLF</LineEndStyle>
                <Delimeter>,</Delimeter>
                <ForceQuotes>False</ForceQuotes>
                <HeaderRow>True</HeaderRow>
                <CodePage>28591</CodePage>
                <WriteBOM>True</WriteBOM>
              </FormatSpecificOptions>
              <MultiFile value="False" />
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <DefaultAnnotationText>Alteryx_sample_output3.csv</DefaultAnnotationText>
              <Left value="False" />
            </Annotation>
          </Properties>
          <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxDbFileOutput" />
        </Node>
        <Node ToolID="43">
          <GuiSettings Plugin="AlteryxBasePluginsGui.Sort.Sort">
            <Position x="858" y="606" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <SortInfo locale="1033">
                <Field field="Reported Country" order="Descending" />
              </SortInfo>
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <DefaultAnnotationText>Reported Country - Descending</DefaultAnnotationText>
              <Left value="False" />
            </Annotation>
          </Properties>
          <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxSort" />
        </Node>
        <Node ToolID="44">
          <GuiSettings Plugin="AlteryxBasePluginsGui.BrowseV2.BrowseV2">
            <Position x="906" y="498" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <Layout>
                <View1>
                  <Hints>
                    <Table />
                  </Hints>
                </View1>
              </Layout>
              <TempFile>C:\Users\SElango4\AppData\Local\Temp\Engine_19656_ca89cf7da406374189bcbeeabc8cf023_\Engine_19656_c84069a18a514e43ba04534ef5e35e52~.yxdb</TempFile>
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <DefaultAnnotationText />
              <Left value="False" />
            </Annotation>
          </Properties>
          <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxBrowseV2" />
        </Node>
        <Node ToolID="45">
          <GuiSettings Plugin="AlteryxBasePluginsGui.BrowseV2.BrowseV2">
            <Position x="978" y="594" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <Layout>
                <View1>
                  <Hints>
                    <Table />
                  </Hints>
                </View1>
              </Layout>
              <TempFile>C:\Users\SElango4\AppData\Local\Temp\Engine_19656_ca89cf7da406374189bcbeeabc8cf023_\Engine_19656_1f94f135cbb80442835bd124c5f1109f~.yxdb</TempFile>
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <DefaultAnnotationText />
              <Left value="False" />
            </Annotation>
          </Properties>
          <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxBrowseV2" />
        </Node>
      </ChildNodes>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxCtrlContainer" />
    </Node>
  </Nodes>
  <Connections>
    <Connection>
      <Origin ToolID="1" Connection="Output" />
      <Destination ToolID="29" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="1" Connection="Output" />
      <Destination ToolID="33" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="2" Connection="Output" />
      <Destination ToolID="24" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="2" Connection="Output" />
      <Destination ToolID="35" Connection="Input" />
    </Connection>
    <Connection name="#1">
      <Origin ToolID="3" Connection="Join" />
      <Destination ToolID="10" Connection="Input" />
    </Connection>
    <Connection name="#2">
      <Origin ToolID="3" Connection="Left" />
      <Destination ToolID="10" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="10" Connection="Output" />
      <Destination ToolID="13" Connection="Left" />
    </Connection>
    <Connection>
      <Origin ToolID="12" Connection="Output" />
      <Destination ToolID="13" Connection="Right" />
    </Connection>
    <Connection>
      <Origin ToolID="10" Connection="Output" />
      <Destination ToolID="30" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="11" Connection="Output" />
      <Destination ToolID="12" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="12" Connection="Output" />
      <Destination ToolID="32" Connection="Input" />
    </Connection>
    <Connection name="#1">
      <Origin ToolID="13" Connection="Join" />
      <Destination ToolID="14" Connection="Input" />
    </Connection>
    <Connection name="#2">
      <Origin ToolID="13" Connection="Left" />
      <Destination ToolID="14" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="14" Connection="Output" />
      <Destination ToolID="28" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="14" Connection="Output" />
      <Destination ToolID="31" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="14" Connection="Output" />
      <Destination ToolID="38" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="28" Connection="Output" />
      <Destination ToolID="37" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="28" Connection="Output" />
      <Destination ToolID="46" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="28" Connection="Output" />
      <Destination ToolID="47" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="33" Connection="True" />
      <Destination ToolID="3" Connection="Left" />
    </Connection>
    <Connection>
      <Origin ToolID="35" Connection="Output" />
      <Destination ToolID="3" Connection="Right" />
    </Connection>
    <Connection>
      <Origin ToolID="33" Connection="True" />
      <Destination ToolID="34" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="35" Connection="Output" />
      <Destination ToolID="36" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="38" Connection="Output" />
      <Destination ToolID="39" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="38" Connection="Output" />
      <Destination ToolID="41" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="39" Connection="Output" />
      <Destination ToolID="40" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="39" Connection="Output" />
      <Destination ToolID="44" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="41" Connection="Unique" />
      <Destination ToolID="43" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="43" Connection="Output" />
      <Destination ToolID="42" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="43" Connection="Output" />
      <Destination ToolID="45" Connection="Input" />
    </Connection>
  </Connections>
  <Properties>
    <Memory default="True" />
    <GlobalRecordLimit value="0" />
    <TempFiles default="True" />
    <Annotation on="True" includeToolName="False" />
    <ConvErrorLimit value="10" />
    <ConvErrorLimit_Stop value="False" />
    <CancelOnError value="False" />
    <DisableBrowse value="False" />
    <EnablePerformanceProfiling value="False" />
    <RunWithE2 value="True" />
    <PredictiveToolsCodePage value="1252" />
    <DisableAllOutput value="False" />
    <ShowAllMacroMessages value="False" />
    <ShowConnectionStatusIsOn value="True" />
    <ShowConnectionStatusOnlyWhenRunning value="True" />
    <ZoomLevel value="0" />
    <LayoutType>Horizontal</LayoutType>
    <MetaInfo>
      <NameIsFileName value="True" />
      <Name>Alteryx_sample3</Name>
      <Description />
      <RootToolName />
      <ToolVersion />
      <ToolInDb value="False" />
      <CategoryName />
      <SearchTags />
      <Author />
      <Company />
      <Copyright />
      <DescriptionLink actual="" displayed="" />
      <Example>
        <Description />
        <File />
      </Example>
      <WorkflowId value="bbae5f60-7529-40d0-85b3-5c2e83f1d343" />
      <Telemetry>
        <PreviousWorkflowId value="6f7081dd-ee5c-49a3-814e-f4ebf5eebb08" />
        <OriginWorkflowId value="b40a7404-6a92-4313-a898-a18e226e8a4d" />
      </Telemetry>
      <PlatformWorkflowId value="" />
    </MetaInfo>
    <Events>
      <Enabled value="False" />
    </Events>
  </Properties>
</AlteryxDocument>
